---
title: "Summary"
output:
  html_document:
    toc: yes
    toc_depth: 3
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(
  warning = FALSE
)
library("psych", lib.loc = "~/R/win-library/3.3")
library("zoom", lib.loc = "~/R/win-library/3.3")
library("knitr", lib.loc = "~/R/win-library/3.3")

```

```{r load data, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

Statistics <-
  read.csv(
    file = "Parameters.csv",
    header = TRUE,
    sep = ",",
    quote = "\"",
    dec = "."
  )
stat <- Statistics[, -40:-69]
stat <- stat[, -16]
stat <- stat[, -15]
stat <- stat[, -9]
stat <- stat[, -7]
stat <- stat[, -6]
stat <- stat[, -2]

stat <- stat[stat[,"time_CPU"] >= 1,]
asdf <- Statistics[, -40:-70]
asdf <- asdf[, -3:-36]

mininst <- 7
problems <- unique(stat[, 1])
```

# Overall Summary
```{r Overall Summary, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

oSummary = matrix(nrow = 0, ncol = 5)

cat("Number Problems: ", length(unique(stat[, 1])), "\n")
cat("Number Instanzes: ", length(stat[, 1]), "\n")
for (col in 2:length(colnames(stat))) {
    oSummary <-
      rbind(oSummary, c(
      colnames(stat)[col],
      min(stat[, col], na.rm = TRUE),
      max(stat[, col], na.rm = TRUE),
      mean(stat[, col], na.rm = TRUE),
      median(stat[, col], na.rm = TRUE)
      ))
}
kable(oSummary, digits=3, col.names = c("Statistic","Min","Max","Avg","Median"))

```

# Summary per problem
## Number of instances per problem
```{r Summary per problem, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

su = matrix(nrow = 0, ncol = 6)
overview = matrix(nrow = 0, ncol = 2)

for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  overview <-
    rbind(overview, c(pro, sum(!is.na(st[, 1]))))
  for (col in 2:length(colnames(stat))) {
    su <-
      rbind(su, c(
        pro,
        colnames(stat)[col],
        min(st[, col], na.rm = TRUE),
        max(st[, col], na.rm = TRUE),
        mean(st[, col], na.rm = TRUE),
        median(st[, col], na.rm = TRUE)
      ))
  }
}
kable(overview[order(overview[, 2], decreasing = TRUE),], digits=3, col.names = c("Problem","Number of Instances"))
# kable(su, digits=3, col.names = c("Problem","Statistic","Min","Max","Mean","Median"))

```


## Parameter min max mean and median per problem
```{r Summary per problem2, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}

asdf = matrix(nrow = 0, ncol = (length(unique(stat[, 1]))+2))
pronames <- c("statistic", "type")
  for (pro in unique(stat[, 1])) {
    pronames <- c(pronames,pro)
  }

for (col in 2:length(colnames(stat))) {
  minrow <- c(colnames(stat)[col], "min")
  maxrow <- c(colnames(stat)[col], "max")
  meanrow <- c(colnames(stat)[col], "mean")
  medianrow <-  c(colnames(stat)[col], "median")
  for (pro in unique(stat[, 1])) {
    st <- stat[stat$problem == pro,]
    minrow <- c(minrow, min(st[, col], na.rm = TRUE))
    maxrow <- c(maxrow, max(st[, col], na.rm = TRUE))
    meanrow <- c(meanrow, mean(st[, col], na.rm = TRUE))
    medianrow <-  c(medianrow, median(st[, col], na.rm = TRUE))
  }
  asdf <-    rbind(asdf, minrow)
  asdf <-    rbind(asdf, maxrow)
  asdf <-    rbind(asdf, meanrow)
  asdf <-    rbind(asdf, medianrow)
}
asdf <- asdf[,c(1,2,order(pronames[-c(1,2)])+2)]
kable(asdf,
      digits = 3,
      col.names = c("statistic", "type",pronames[(order(pronames[-c(1,2)])+2)]))

```

# Corrlations per problem

```{r correlation preparation Spearman, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
mininst <- 7
numinst <- 0
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  if (lenst >= mininst) {
    numinst <- numinst + 1
  }
}
len <- ncol(stat)

numvalues <- matrix(ncol=len,nrow=length(unique(stat[, 1])))
valmatrix <- list()
for (b in 1:length(unique(stat[, 1]))) {
  valmatrix[[b]] <- stat[stat$problem == unique(stat[, 1])[b], ]
  for (a in 3:len) {
    numvalues[b,a]<-sum(!is.na(valmatrix[[b]][a]))
  }
}

problemnames <- as.character.factor(unique(stat[,1]))
numprobs <- length(unique(stat[, 1]))
columns <- colnames(stat)
```

## one parameter
```{r correlations one parameter per problem Spearman, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}

matrix_interesting <- matrix(ncol = 2, nrow = len)
for (i in 3:len) {
  num <- 1
  cormatrix_stat <- matrix(ncol = 2, nrow = numinst)
  
  for (pro in 1:numprobs) {
    if (numvalues[pro, i] >= mininst) {
      cormatrix_stat[num, 1] <- problemnames[pro]
      a <-
        cor.test(valmatrix[[pro]][[i]], valmatrix[[pro]]$time_CPU, method = "spearman")
      cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
      num <- num + 1
    }
  }
  
  matrix_sorted <-
    cormatrix_stat[order(cormatrix_stat[, 2], decreasing = TRUE), ]
  numhigh <- 0
  numlow <- 0
  for (n in 1:nrow(matrix_sorted)) {
    if (!is.na(matrix_sorted[n, 2])) {
      if (abs(as.numeric(matrix_sorted[n, 2])) >= 0.7) {
        numhigh <- numhigh + 1
      }
      if (abs(as.numeric(matrix_sorted[n, 2])) <= 0.2) {
        numlow <- numlow + 1
      }
    } else{
      break
    }
  }
  matrix_interesting[i, 1] <- numhigh
  matrix_interesting[i, 2] <- numlow
  if (numhigh >= 12) {
    cat(sprintf("\n\n### Time vs. %s\n\n", columns[i]))
    cat(sprintf("\n\nhigh: %i, low: %i \n\n", numhigh, numlow))
    print(kable(matrix_sorted, col.names = c("Problems", "Correlation")))
  }
}
```

## two parameter
```{r correlations two parameter per proble Spearman, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
matrix_two_parameters_high <- matrix(ncol = len, nrow = len)
matrix_two_parameters_low <- matrix(ncol = len, nrow = len)
for (i in 3:len) {
  for (b in 3:len) {
    if (i > b) {
      num <- 1
      cormatrix_stat <- matrix(ncol = 2, nrow = numinst)
      
      for (pro in 1:numprobs) {
        if (numvalues[pro, i] >= mininst &&
            numvalues[pro, b] >= mininst) {
          cormatrix_stat[num, 1] <- problemnames[pro]
          a <-
            cor.test(valmatrix[[pro]][[i]]+valmatrix[[pro]][[b]], valmatrix[[pro]]$time_CPU, method = "spearman")
          cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
          num <- num + 1
        }
      }
      
      matrix_sorted <-
        cormatrix_stat[order(cormatrix_stat[, 2], decreasing = TRUE),]
      numhigh <- 0
      numlow <- 0
      for (n in 1:nrow(matrix_sorted)) {
        if (!is.na(matrix_sorted[n, 2])) {
          if (abs(as.numeric(matrix_sorted[n, 2])) >= 0.7) {
            numhigh <- numhigh + 1
          }
          if (abs(as.numeric(matrix_sorted[n, 2])) <= 0.2) {
            numlow <- numlow + 1
          }
        } else{
          break
        }
      }
      matrix_two_parameters_high[i, b] <- numhigh
      matrix_two_parameters_low[i, b] <- numlow
      matrix_two_parameters_high[b, i] <- numhigh
      matrix_two_parameters_low[b, i] <- numlow
      if (numhigh >= 7 &&
          max(matrix_interesting[i, 1],
              matrix_interesting[b, 1],
              na.rm =
              TRUE) < numhigh) {
        cat(
          sprintf(
            "\n\n### Time vs. %s + %s, improvement: %i \n\n",
            columns[i],
            columns[b],
            numhigh - max(matrix_interesting[i, 1],
                          matrix_interesting[b, 1],
                          na.rm =
                            TRUE)
          )
        )
        cat(sprintf("\n\nhigh: %i, low: %i \n\n", numhigh, numlow))
        cat(
          sprintf(
            "\n\n%s high: %i, low: %i \n\n",
            columns[i],
            matrix_interesting[i, 1],
            matrix_interesting[i, 2]
          )
        )
        cat(
          sprintf(
            "\n\n%s high: %i, low: %i \n\n",
            columns[b],
            matrix_interesting[b, 1],
            matrix_interesting[b, 2]
          )
        )
        print(kable(matrix_sorted,
                    col.names = c("Problems", "Correlation")))
      }
    }
  }
}
```

## three parameter
```{r correlations three parameter per proble Spearman, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
matrix_three_parameters_high <- array(dim=c(len,len,len))
matrix_three_parameters_low <- array(dim=c(len,len,len))
for (i in 3:len) {
  for (b in 3:len) {
    if (i > b) {
      for (c in 3:len) {
        if (b > c) {
          num <- 1
          cormatrix_stat <- matrix(ncol = 2, nrow = numinst)
          
          for (pro in 1:numprobs) {
            if (numvalues[pro, i] >= mininst &&
                numvalues[pro, b] >= mininst &&
                numvalues[pro, c] >= mininst) {
              cormatrix_stat[num, 1] <- problemnames[pro]
              a <-
                cor.test(valmatrix[[pro]][[i]]+valmatrix[[pro]][[b]]+valmatrix[[pro]][[c]], valmatrix[[pro]]$time_CPU, method = "spearman")
              cormatrix_stat[num, 2] <-
                round(a$estimate, digits = 2)
              num <- num + 1
            }
          }
          
          matrix_sorted <-
            cormatrix_stat[order(cormatrix_stat[, 2], decreasing = TRUE),]
          numhigh <- 0
          numlow <- 0
          for (n in 1:nrow(matrix_sorted)) {
            if (!is.na(matrix_sorted[n, 2])) {
              if (abs(as.numeric(matrix_sorted[n, 2])) >= 0.7) {
                numhigh <- numhigh + 1
              }
              if (abs(as.numeric(matrix_sorted[n, 2])) <= 0.2) {
                numlow <- numlow + 1
              }
            } else{
              break
            }
          }
          matrix_three_parameters_high[i, b, c] <- numhigh
          matrix_three_parameters_high[i, c, b] <- numhigh
          matrix_three_parameters_high[b, i, c] <- numhigh
          matrix_three_parameters_high[b, c, i] <- numhigh
          matrix_three_parameters_high[c, i, b] <- numhigh
          matrix_three_parameters_high[c, b, i] <- numhigh
          matrix_three_parameters_low[i, b, c] <- numlow
          matrix_three_parameters_low[i, c, b] <- numlow
          matrix_three_parameters_low[b, i, c] <- numlow
          matrix_three_parameters_low[b, c, i] <- numlow
          matrix_three_parameters_low[c, i, b] <- numlow
          matrix_three_parameters_low[c, b, i] <- numlow
          
          if (numhigh >= 8 &&
              max(
                matrix_two_parameters_high[i, b],
                matrix_two_parameters_high[i, c],
                matrix_two_parameters_high[b, c],
                matrix_interesting[i, 1],
                matrix_interesting[b, 1],
                matrix_interesting[c, 1],
                na.rm =
                TRUE
              ) < numhigh) {
            cat(
              sprintf(
                "\n\n### Time vs. %s + %s + %s, improvement: %i \n\n",
                columns[i],
                columns[b],
                columns[c],
                numhigh - max(
                  matrix_two_parameters_high[i, b],
                  matrix_two_parameters_high[i, c],
                  matrix_two_parameters_high[b, c],
                  matrix_interesting[i, 1],
                  matrix_interesting[b, 1],
                  matrix_interesting[c, 1],
                  na.rm =
                    TRUE
                )
              )
            )
            cat(sprintf("\n\nhigh: %i, low: %i \n\n", numhigh, numlow))
            cat(
              sprintf(
                "\n\n%s + %s high: %i, low: %i\n\n",
                columns[i],
                columns[b],
                matrix_two_parameters_high[i, b],
                matrix_two_parameters_low[i, b]
              )
            )
            cat(
              sprintf(
                "\n\n%s + %s high: %i, low: %i\n\n",
                columns[i],
                columns[c],
                matrix_two_parameters_high[i, c],
                matrix_two_parameters_low[i, c]
              )
            )
            cat(
              sprintf(
                "\n\n%s + %s high: %i, low: %i\n\n",
                columns[c],
                columns[b],
                matrix_two_parameters_high[c, b],
                matrix_two_parameters_low[c, b]
              )
            )
            cat(
              sprintf(
                "\n\n%s high: %i, low: %i \n\n",
                columns[i],
                matrix_interesting[i, 1],
                matrix_interesting[i, 2]
              )
            )
            cat(
              sprintf(
                "\n\n%s high: %i, low: %i \n\n",
                columns[b],
                matrix_interesting[b, 1],
                matrix_interesting[b, 2]
              )
            )
            cat(
              sprintf(
                "\n\n%s high: %i, low: %i \n\n",
                columns[c],
                matrix_interesting[c, 1],
                matrix_interesting[c, 2]
              )
            )
            print(kable(
              matrix_sorted,
              col.names = c("Problems", "Correlation")
            ))
          }
        }
      }
    }
  }
}
```

## four parameter
```{r correlations four parameter per proble Spearman, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
for (i in 3:len) {
  for (b in 3:len) {
    if (i > b) {
      for (c in 3:len) {
        if (b > c) {
          for (d in 3:len) {
            if (c > d) {
              num <- 1
              cormatrix_stat <- matrix(ncol = 2, nrow = numinst)
              
              for (pro in 1:numprobs) {
                if (numvalues[pro, i] >= mininst &&
                    numvalues[pro, b] >= mininst &&
                    numvalues[pro, c] >= mininst &&
                    numvalues[pro, d] >= mininst) {
                  cormatrix_stat[num, 1] <- problemnames[pro]
                  a <-
                    cor.test(
                      valmatrix[[pro]][[i]] + valmatrix[[pro]][[b]] + valmatrix[[pro]][[c]] +
                        valmatrix[[pro]][[d]],
                      valmatrix[[pro]]$time_CPU,
                      method = "spearman"
                    )
                  cormatrix_stat[num, 2] <-
                    round(a$estimate, digits = 2)
                  num <- num + 1
                }
              }
              
              matrix_sorted <-
                cormatrix_stat[order(cormatrix_stat[, 2], decreasing = TRUE), ]
              numhigh <- 0
              numlow <- 0
              for (n in 1:nrow(matrix_sorted)) {
                if (!is.na(matrix_sorted[n, 2])) {
                  if (abs(as.numeric(matrix_sorted[n, 2])) >= 0.7) {
                    numhigh <- numhigh + 1
                  }
                  if (abs(as.numeric(matrix_sorted[n, 2])) <= 0.2) {
                    numlow <- numlow + 1
                  }
                } else{
                  break
                }
              }
              if (numhigh >= 9 &&
                  max(
                    matrix_three_parameters_high[i, b, c],
                    matrix_three_parameters_high[i, c, d],
                    matrix_three_parameters_high[i, b, d],
                    matrix_three_parameters_high[b, c, d],
                    matrix_two_parameters_high[i, b],
                    matrix_two_parameters_high[i, c],
                    matrix_two_parameters_high[i, d],
                    matrix_two_parameters_high[b, c],
                    matrix_two_parameters_high[b, d],
                    matrix_two_parameters_high[c, d],
                    matrix_interesting[i, 1],
                    matrix_interesting[b, 1],
                    matrix_interesting[c, 1],
                    matrix_interesting[d, 1],
                    na.rm =
                    TRUE
                  ) < numhigh) {
                cat(
                  sprintf(
                    "\n\n### Time vs. %s + %s + %s + %s, improvement: %i \n\n",
                    columns[i],
                    columns[b],
                    columns[c],
                    columns[d],
                    numhigh - max(
                      matrix_three_parameters_high[i, b, c],
                      matrix_three_parameters_high[i, c, d],
                      matrix_three_parameters_high[i, b, d],
                      matrix_three_parameters_high[b, c, d],
                      matrix_two_parameters_high[i, b],
                      matrix_two_parameters_high[i, c],
                      matrix_two_parameters_high[i, d],
                      matrix_two_parameters_high[b, c],
                      matrix_two_parameters_high[b, d],
                      matrix_two_parameters_high[c, d],
                      matrix_interesting[i, 1],
                      matrix_interesting[b, 1],
                      matrix_interesting[c, 1],
                      matrix_interesting[d, 1],
                      na.rm =
                        TRUE
                    )
                  )
                )
                ################
                cat(sprintf("\n\nhigh: %i, low: %i \n\n", numhigh, numlow))
                #################
                cat(
                  sprintf(
                    "\n\n%s + %s + %s high: %i, low: %i\n\n",
                    columns[i],
                    columns[b],
                    columns[c],
                    matrix_three_parameters_high[i, b, c],
                    matrix_three_parameters_low[i, b, c]
                  )
                )
                cat(
                  sprintf(
                    "\n\n%s + %s + %s high: %i, low: %i\n\n",
                    columns[i],
                    columns[c],
                    columns[d],
                    matrix_three_parameters_high[i, c, d],
                    matrix_three_parameters_low[i, c, d]
                  )
                )
                cat(
                  sprintf(
                    "\n\n%s + %s + %s high: %i, low: %i\n\n",
                    columns[i],
                    columns[b],
                    columns[d],
                    matrix_three_parameters_high[i, b, d],
                    matrix_three_parameters_low[i, b, d]
                  )
                )
                cat(
                  sprintf(
                    "\n\n%s + %s + %s high: %i, low: %i\n\n",
                    columns[b],
                    columns[c],
                    columns[d],
                    matrix_three_parameters_high[b, c, d],
                    matrix_three_parameters_low[b, c, d]
                  )
                )
                ###########
                cat(
                  sprintf(
                    "\n\n%s + %s high: %i, low: %i\n\n",
                    columns[i],
                    columns[b],
                    matrix_two_parameters_high[i, b],
                    matrix_two_parameters_low[i, b]
                  )
                )
                cat(
                  sprintf(
                    "\n\n%s + %s high: %i, low: %i\n\n",
                    columns[i],
                    columns[c],
                    matrix_two_parameters_high[i, c],
                    matrix_two_parameters_low[i, c]
                  )
                )
                cat(
                  sprintf(
                    "\n\n%s + %s high: %i, low: %i\n\n",
                    columns[i],
                    columns[d],
                    matrix_two_parameters_high[i, d],
                    matrix_two_parameters_low[i, d]
                  )
                )
                cat(
                  sprintf(
                    "\n\n%s + %s high: %i, low: %i\n\n",
                    columns[b],
                    columns[c],
                    matrix_two_parameters_high[b, c],
                    matrix_two_parameters_low[b, c]
                  )
                )
                cat(
                  sprintf(
                    "\n\n%s + %s high: %i, low: %i\n\n",
                    columns[b],
                    columns[d],
                    matrix_two_parameters_high[b, d],
                    matrix_two_parameters_low[b, d]
                  )
                )
                cat(
                  sprintf(
                    "\n\n%s + %s high: %i, low: %i\n\n",
                    columns[c],
                    columns[d],
                    matrix_two_parameters_high[c, d],
                    matrix_two_parameters_low[c, d]
                  )
                )
                ############
                cat(
                  sprintf(
                    "\n\n%s high: %i, low: %i \n\n",
                    columns[i],
                    matrix_interesting[i, 1],
                    matrix_interesting[i, 2]
                  )
                )
                cat(
                  sprintf(
                    "\n\n%s high: %i, low: %i \n\n",
                    columns[b],
                    matrix_interesting[b, 1],
                    matrix_interesting[b, 2]
                  )
                )
                cat(
                  sprintf(
                    "\n\n%s high: %i, low: %i \n\n",
                    columns[c],
                    matrix_interesting[c, 1],
                    matrix_interesting[c, 2]
                  )
                )
                cat(
                  sprintf(
                    "\n\n%s high: %i, low: %i \n\n",
                    columns[d],
                    matrix_interesting[d, 1],
                    matrix_interesting[d, 2]
                  )
                )
                print(kable(
                  matrix_sorted,
                  col.names = c("Problems", "Correlation")
                ))
              }
            }
          }
        }
      }
    }
  }
}
```

# k Consistency

## numAtomsHead
```{r Number of Atoms in the Head Spearman, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <- cor.test(st$numAtomsHead, st$time_CPU, method="spearman")
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))

```

## maxSizeRuleHead + rules
```{r Maximum size of the Head of a rule + Number of Rules Spearman, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <- cor.test(st$maxSizeRuleHead + st$rules, st$time_CPU, method="spearman")
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))

```

## maxSizeAnswerSet + maxSizeHeadNegBodyRule
```{r Maximum size of an answer set + Maximum size of the head and negative body of a rule Spearman, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <- cor.test(st$maxSizeAnswerSet + st$maxSizeHeadNegBodyRule, st$time_CPU, method="spearman")
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))

```

## numNonHornClauses + maxSizeHeadNegBodyRule
```{r Number non Horn rules + Maximum size of the head and negative body of a rule Spearman, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <-
      cor.test(st$numNonHornClauses + st$maxSizeHeadNegBodyRule, st$time_CPU, method="spearman")
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))

```

## maxSizeAnswerSet + numAtomsPosBody + maxNumVarOccHeadNegBody + maxSizeNegBodyCon + numAtomsNegBody
```{r Maximum size of an answer set + Number of Atoms in the positive body + Maximum Number of Occurences of a variable when only head and negative body + Maximum size of the negative body of an constraint + Number of Atoms in the negative body Spearman, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <-
      cor.test(
        st$maxSizeAnswerSet + st$numAtomsPosBody + st$maxNumVarOccHeadNegBody + st$maxSizeNegBodyCon + st$numAtomsNegBody,
        st$time_CPU, method="spearman"
      )
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))

```

## numAtomsPosBody + numNonHornClauses + maxSizeNegBodyCon + numAtomsNegBody
```{r Number of Atoms in the positive body + Number non Horn rules + Maximum size of the negative body of an constraint + Number of Atoms in the negative body Spearman, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <-
      cor.test(
        st$numAtomsPosBody + st$numNonHornClauses + st$maxSizeNegBodyCon + st$numAtomsNegBody,
        st$time_CPU, method="spearman"
      )
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[, 2], decreasing = TRUE), ], col.names = c("Problems", "Correlation")))

```

## maxSizeAnswerSet + numAtomsPosBody + maxNumVarOccHeadNegBody + rules + numAtomsNegBody
```{r Maximum size of an answer set + Number of Atoms in the positive body + Maximum Number of Occurences of a variable when only head and negative body + Number of Rules + Number of Atoms in the negative body Spearman, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <-
      cor.test(
        st$maxSizeAnswerSet + st$numAtomsPosBody + st$maxNumVarOccHeadNegBody + st$rules +
          st$numAtomsNegBody,
        st$time_CPU, method="spearman"
      )
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))

```

## numAtomsPosBody + numNonHornClauses + rules + numAtomsNegBody
```{r Number of Atoms in the positive body + Number non Horn rules + Number of Rules + Number of Atoms in the negative body Spearman, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <-
      cor.test(st$numAtomsPosBody + st$numNonHornClauses + st$rules + st$numAtomsNegBody,
               st$time_CPU, method="spearman")
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))

```

## rules + numAtomsNegBody
```{r Number of Rules + Number of Atoms in the negative body Spearman, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <- cor.test(st$rules + st$numAtomsNegBody, st$time_CPU, method="spearman")
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))

```

## maxSizeHeadNegBodyRule + numNonHornClauses
```{r Maximum size of the head and negative body of a rule + Number non Horn rules Spearman, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <-
      cor.test(st$maxSizeHeadNegBodyRule + st$numNonHornClauses, st$time_CPU, method="spearman")
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))

```

## rules
```{r Number of Rules Spearman, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <- cor.test(st$rules, st$time_CPU, method="spearman")
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))

```

## maxSizeAnswerSet
```{r Maximum size of an answer set Spearman, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <- cor.test(st$maxSizeAnswerSet, st$time_CPU, method="spearman")
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))

```

# Hardness
## maxSizeNCon + maxNumAtomOcc + numAtomsPosBody + constraints + maxSizeNegBodyCon + numAtomOccC
```{r spearman maxSizeNCon + maxNumAtomOcc + numAtomsPosBody + constraints + maxSizeNegBodyCon + numAtomOccC, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <- cor.test(st$maxSizeNCon + st$maxNumAtomOcc + st$numAtomsPosBody + st$constraints + st$maxSizeNegBodyCon + st$numAtomOccC, st$time_CPU, method="spearman")
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))

```

## maxSizeAnswerSet + maxSizeNegBodyRule + maxSizePosBodyCon + maxSizeNegBodyCon
```{r spearman maxSizeAnswerSet + maxSizeNegBodyRule + maxSizePosBodyCon + maxSizeNegBodyCon, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <- cor.test(st$maxSizeAnswerSet + st$maxSizeNegBodyRule + st$maxSizePosBodyCon + st$maxSizeNegBodyCon, st$time_CPU, method="spearman")
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))
```

## maxSizeAnswerSet + maxSizePosBodyNCon + numAtomsPosBody + constraints + maxSizeNegBodyCon + numAtomOccC
```{r spearman maxSizeAnswerSet + maxSizePosBodyNCon + numAtomsPosBody + constraints + maxSizeNegBodyCon + numAtomOccC, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <- cor.test(st$maxSizeAnswerSet + st$maxSizePosBodyNCon + st$numAtomsPosBody + st$constraints + st$maxSizeNegBodyCon + st$numAtomOccC, st$time_CPU, method="spearman")
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))
```

## maxSizeAnswerSet + maxSizePosBodyNCon + numNonHornClauses + maxNumAtomOcc + numAtomsPosBody + rules
```{r spearman maxSizeAnswerSet + maxSizePosBodyNCon + numNonHornClauses + maxNumAtomOcc + numAtomsPosBody + rules, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <- cor.test(st$maxSizeAnswerSet + st$maxSizePosBodyNCon + st$numNonHornClauses + st$maxNumAtomOcc + st$numAtomsPosBody + st$rules, st$time_CPU, method="spearman")
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))
```

## maxSizeAnswerSet + maxSizePosBodyNCon + numNonHornClauses + maxNumVarOccHeadNegBody + constraints + maxSizeNegBodyCon + numAtomOccC
```{r spearman maxSizeAnswerSet + maxSizePosBodyNCon + numNonHornClauses + maxNumVarOccHeadNegBody + constraints + maxSizeNegBodyCon + numAtomOccC, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <- cor.test(st$maxSizeAnswerSet + st$maxSizePosBodyNCon + st$numNonHornClauses + st$maxNumVarOccHeadNegBody + st$constraints + st$maxSizeNegBodyCon + st$numAtomOccC, st$time_CPU, method="spearman")
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))
```

## maxSizePosBodyNCon + numNonHornClauses + maxNumAtomOcc + constraints + maxSizeNegBodyCon + numAtomOccC
```{r spearman maxSizePosBodyNCon + numNonHornClauses + maxNumAtomOcc + constraints + maxSizeNegBodyCon + numAtomOccC, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <- cor.test(st$maxSizePosBodyNCon + st$numNonHornClauses + st$maxNumAtomOcc + st$constraints + st$maxSizeNegBodyCon + st$numAtomOccC, st$time_CPU, method="spearman")
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))
```

## maxSizeAnswerSet + maxSizePosBodyNCon + numNonHornClauses + maxNumAtomOcc + rules + maxSizeNegBodyCon
```{r spearman maxSizeAnswerSet + maxSizePosBodyNCon + numNonHornClauses + maxNumAtomOcc + rules + maxSizeNegBodyCon, echo=FALSE, message=FALSE, warning=FALSE,results='asis'}
num <- 1
cormatrix_stat <- matrix(ncol = 2, nrow = numprobs)
for (pro in unique(stat[, 1])) {
  st <- stat[stat$problem == pro, ]
  lenst <- sum(!is.na(st[, 1]))
  cormatrix_stat[num, 1] <- pro
  if (lenst >= mininst) {
    a <- cor.test(st$maxSizeAnswerSet + st$maxSizePosBodyNCon + st$numNonHornClauses + st$maxNumAtomOcc + st$rules + st$maxSizeNegBodyCon, st$time_CPU, method="spearman")
    cormatrix_stat[num, 2] <- round(a$estimate, digits = 2)
  }
  num <- num + 1
}
print(kable(cormatrix_stat[order(cormatrix_stat[,2],decreasing = TRUE),],col.names = c("Problems","Correlation")))
```




